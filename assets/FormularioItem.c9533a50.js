import{J as h,r as m,U as q,K as u,at as C,L as b,W as v,O as r,M as s,Y as n,V as j,p as x,Q as g,X as D,au as E}from"./index.00c1b7ba.js";import{B as F,c as N,d as P,Q as A,C as L}from"./BorrarItem.f88052be.js";import{u as G,c as J,Q,a as K,b as t}from"./QCard.5686ad5f.js";import{a as M}from"./QPageSticky.d153300a.js";import{c as U,n as B,s as w,m as _}from"./supabase.7a60f0a8.js";import{u as O}from"./app.9f400080.js";const T={emits:["nuevo","editado","borrado"],components:{BorrarItem:F},props:["editar"],setup(S,{emit:o}){const c=G(),e=m(!1),f=m(null);O();const d=m({}),p=m(null),l=m(null),V=m(!1),y=m();function k(a,i){a?(f.value="Editar",p.value=i,l.value=a.id,console.log(a),d.value={nombre:a.nombre,nombre2:a.nombre2,apellido1:a.apellido1,apellido2:a.apellido2,ni:a.ni,email:a.email,telefono:a.telefono,direccion:a.direccion,cargo:a.cargo.id}):(f.value="Crear",d.value={}),e.value=!0}async function z(){if(e.value=!1,U(!0),f.value==="Crear"){d.value.negocio=B.id;const{data:a,error:i}=await w.from("trabajadores").insert(d.value).select("id,nombre,cargo");i?_(i):(o("nuevo",a[0]),c.notify({type:"positive",message:"Acci\xF3n realizada con \xE9xito."}))}else{console.clear(),console.log(d.value),console.log(l.value);const{data:a,error:i}=await w.from("trabajadores").update(d.value).eq("id",l.value).select("id,nombre,cargo");i?_(i):(o("editado",a[0],p.value),c.notify({type:"positive",message:"Acci\xF3n realizada con \xE9xito."}))}U(!1)}async function I(){let{data:a,error:i}=await w.from("cargos").select("id,nombre,salario_base").eq("negocio",B.id);i?_(i):(y.value=a,V.value=!1)}return I(),{dialog:e,rules:[a=>a&&a.length>0||"Complete este campo"],mostrar:k,loading:V,accion:f,onSubmit:z,row:d,index:p,id:l,borrado:function(a){e.value=!1,o("borrado",a)},cargos:y}}},W={class:"text-h6"},X={key:0},Y=n("br",null,null,-1),H={class:"row q-col-gutter-md"},R={class:"col-12 col-sm-6"},Z={class:"col-12 col-sm-6"},$={class:"row q-col-gutter-md"},ee={class:"col-12 col-sm-6"},oe={class:"col-12 col-sm-6"},le={class:"row q-col-gutter-md"},ae={class:"col-12 col-sm-6"},re={class:"col-12 col-sm-6"},ne=n("br",null,null,-1),ie={class:"row"},se={class:"col"},de={class:"col-auto text-right"};function te(S,o,c,e,f,d){const p=q("BorrarItem");return u(),C(E,null,[c.editar?(u(),b(v,{key:0,class:"animate__animated animate__slideInUp",push:"",fab:"",icon:"edit",color:"accent",onClick:o[0]||(o[0]=l=>e.mostrar(c.editar))})):(u(),b(v,{key:1,class:"animate__animated animate__slideInUp",push:"",fab:"",icon:"add",color:"accent",onClick:o[1]||(o[1]=l=>e.mostrar())})),r(A,{modelValue:e.dialog,"onUpdate:modelValue":o[11]||(o[11]=l=>e.dialog=l),persistent:"","transition-show":"slide-down","transition-hide":"slide-down"},{default:s(()=>[r(J,{style:{width:"700px","max-width":"80vw"}},{default:s(()=>[r(Q,{class:"row items-center q-pb-none"},{default:s(()=>[n("div",W,j(e.accion)+" trabajador",1),r(N),x(r(v,{icon:"close",flat:"",round:"",dense:""},null,512),[[L]])]),_:1}),e.loading?(u(),C("div",X,[Y,r(M,{indeterminate:""})])):(u(),b(Q,{key:1},{default:s(()=>[r(K,{onSubmit:e.onSubmit},{default:s(()=>[n("div",H,[n("div",R,[r(t,{filled:"",modelValue:e.row.nombre,"onUpdate:modelValue":o[2]||(o[2]=l=>e.row.nombre=l),label:"Primer nombre","lazy-rules":"",rules:e.rules},null,8,["modelValue","rules"])]),n("div",Z,[r(t,{filled:"",modelValue:e.row.nombre2,"onUpdate:modelValue":o[3]||(o[3]=l=>e.row.nombre2=l),label:"Segundo nombre"},null,8,["modelValue"])])]),n("div",$,[n("div",ee,[r(t,{filled:"",modelValue:e.row.apellido1,"onUpdate:modelValue":o[4]||(o[4]=l=>e.row.apellido1=l),label:"Primer apellido","lazy-rules":"",rules:e.rules},null,8,["modelValue","rules"])]),n("div",oe,[r(t,{filled:"",modelValue:e.row.apellido2,"onUpdate:modelValue":o[5]||(o[5]=l=>e.row.apellido2=l),label:"Segundo apellido","lazy-rules":"",rules:e.rules},null,8,["modelValue","rules"])])]),r(t,{filled:"",modelValue:e.row.ni,"onUpdate:modelValue":o[6]||(o[6]=l=>e.row.ni=l),type:"number",label:"N\xFAmero de identidad","lazy-rules":"",rules:e.rules},{prepend:s(()=>[r(g,{name:"badge"})]),_:1},8,["modelValue","rules"]),n("div",le,[n("div",ae,[r(t,{filled:"",modelValue:e.row.email,"onUpdate:modelValue":o[7]||(o[7]=l=>e.row.email=l),type:"email",label:"Correo electr\xF3nico","lazy-rules":"",rules:e.rules},{prepend:s(()=>[r(g,{name:"email"})]),_:1},8,["modelValue","rules"])]),n("div",re,[r(t,{filled:"",modelValue:e.row.telefono,"onUpdate:modelValue":o[8]||(o[8]=l=>e.row.telefono=l),type:"phone",label:"Tel\xE9fono","lazy-rules":"",rules:e.rules},{prepend:s(()=>[r(g,{name:"phone"})]),_:1},8,["modelValue","rules"])])]),r(t,{filled:"",modelValue:e.row.direccion,"onUpdate:modelValue":o[9]||(o[9]=l=>e.row.direccion=l),type:"textarea",autogrow:"",label:"Direcci\xF3n particular","lazy-rules":"",rules:e.rules},{prepend:s(()=>[r(g,{name:"place"})]),_:1},8,["modelValue","rules"]),r(P,{filled:"",modelValue:e.row.cargo,"onUpdate:modelValue":o[10]||(o[10]=l=>e.row.cargo=l),options:e.cargos,label:"Cargo","emit-value":"","map-options":"","option-value":"id","option-label":"nombre","lazy-rules":"",rules:[l=>!!l||"Complete este campo"]},null,8,["modelValue","options","rules"]),ne,n("div",ie,[n("div",se,[e.accion==="Editar"?(u(),b(p,{key:0,index:e.index,id:e.id,tabla:"trabajadores",onBorrado:e.borrado},null,8,["index","id","onBorrado"])):D("",!0)]),n("div",de,[r(v,{push:"","no-caps":"",type:"submit",label:"Guardar",color:"primary"})])])]),_:1},8,["onSubmit"])]),_:1}))]),_:1})]),_:1},8,["modelValue"])],64)}var ve=h(T,[["render",te]]);export{ve as F};
