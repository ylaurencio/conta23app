import{Q as y,a as q}from"./QTable.722c96f7.js";import{J as x,b as j,r as d,K as P,L as k,M as l,U as F,O as s,R as I,V as m,W as T}from"./index.00c1b7ba.js";import{Q as h}from"./QPageSticky.d153300a.js";import{Q as E}from"./QPage.86c4b5c1.js";import{u as S}from"./QCard.5686ad5f.js";import{c as B,s as g,n as p,m as b}from"./supabase.7a60f0a8.js";import{u as V}from"./app.9f400080.js";import{F as C}from"./FormularioItem.c9533a50.js";import"./QSeparator.a6d41f63.js";import"./uid.c4af4a8b.js";import"./QList.33562488.js";import"./BorrarItem.f88052be.js";import"./format.87ff2225.js";const L={components:{FormularioItem:C},setup(){S();const v=V(),u=j();v.titulo=u.currentRoute._value.name;const f=d(null),e=d([]),w=d(""),c=d(!1),r=d({sortBy:null,descending:!1,page:1,rowsPerPage:25,rowsNumber:0});async function a(o,n){if(r.value.sortBy){let{data:t,error:i}=await g.from("trabajadores").select("id,nombre,nombre2,apellido1,apellido2,cargo").eq("negocio",p.id).order(r.value.sortBy,{ascending:!r.value.descending}).range(o,n);i?b(i):e.value=t}else{let{data:t,error:i}=await g.from("trabajadores").select("id,nombre,nombre2,apellido1,apellido2,cargo").eq("negocio",p.id).range(o,n);i?b(i):e.value=t}c.value=!1,B(!1)}async function Q(){B(!0);const{count:o,error:n}=await g.from("trabajadores").select("*",{count:"exact",head:!0}).eq("negocio",p.id);n?b(n):(r.value.rowsNumber=o,a(0,24))}Q();function R(o){c.value=!0,r.value=o.pagination;const{page:n,rowsPerPage:t,sortBy:i,descending:A}=o.pagination;if(t===0)a(0,r.value.rowsNumber-1);else{const _=(n-1)*t,N=_+t-1;a(_,N)}}return{rows:e,onRequest:R,filter:w,loading:c,pagination:r,columns:[{name:"nombre",align:"left",label:"Nombre",field:"nombre",sortable:!0},{name:"opcion",align:"left",label:"",field:o=>"$ "+o.salario_base,sortable:!1}],formulario:f,borrado:function(o){e.value.splice(o,1)},nuevo:function(o){e.value.push(o)},editar:function(o){f.value.mostrar(o.row,o.pageIndex)},editado:function(o,n){e.value[n]=o}}}};function U(v,u,f,e,w,c){const r=F("FormularioItem");return P(),k(E,{padding:""},{default:l(()=>[s(q,{rows:e.rows,columns:e.columns,"row-key":"id",pagination:e.pagination,"onUpdate:pagination":u[0]||(u[0]=a=>e.pagination=a),loading:e.loading,filter:e.filter,onRequest:e.onRequest},{"body-cell-nombre":l(a=>[s(y,{props:a},{default:l(()=>[I(m(a.row.nombre)+" "+m(a.row.nombre2)+" "+m(a.row.apellido1)+" "+m(a.row.apellido2),1)]),_:2},1032,["props"])]),"body-cell-opcion":l(a=>[s(y,{props:a},{default:l(()=>[s(T,{label:"ver","no-caps":"",flat:"",color:"info",link:"",to:"/trabajadores/"+a.row.id},null,8,["to"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","loading","filter","onRequest"]),s(h,{position:"bottom-right",offset:[18,18]},{default:l(()=>[s(r,{ref:"formulario",onNuevo:e.nuevo,onEditado:e.editado,onBorrado:e.borrado},null,8,["onNuevo","onEditado","onBorrado"])]),_:1})]),_:1})}var oo=x(L,[["render",U]]);export{oo as default};
